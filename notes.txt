Sun: 11/27/2016

Made ~/projects/iccj

Created github repo:  https://github.com/strongwares/iccj

git clone https://github.com/strongwares/iccj.git
~/projects/iccj
README.md

git config --global user.email "strongwares@gmail.com"
git config --global user.name "strongwares"

git remote add origin https://github.com/strongwares/iccj.git

git add <>
git commit -m "..."
git push -u origin master

mkdir -p src/main/java/org/iotacontrolcenter/ui/properties
mkdir -p src/main/java/org/iotacontrolcenter/ui/proxy
mkdir -p src/main/java/org/iotacontrolcenter/ui/dialog
mkdir -p src/main/java/org/iotacontrolcenter/ui/panel
mkdir -p src/main/java/org/iotacontrolcenter/ui/app

cp -r ~/projects/iccr/iccr/properties/src/main/java/org/iotacontrolcenter/properties/locale src/main/java/org/iotacontrolcenter/ui/properties
cp -r ~/projects/iccr/iccr/properties/src/main/java/org/iotacontrolcenter/properties/source src/main/java/org/iotacontrolcenter/ui/properties
cp -r ~/projects/iccr/iccr/properties/src/main/java/org/iotacontrolcenter/properties/util src/main/java/org/iotacontrolcenter/ui/properties


install oracle jdk 8
sudo add-apt-repository ppa:webupd8team/java
sudo apt update
sudo apt-get install oracle-java8-installer

sudo rm /usr/lib/jvm/default-java
sudo ln -s /usr/lib/jvm/java-8-oracle  /usr/lib/jvm/default-java

enable ssh on optiplex ubuntu:
sudo apt-get install openssh-client
sudo apt-get install openssh-server
sudo systemctl restart sshd.service

tested jfx and swing, go with swing
cp src/main/java/org/iotacontrolcenter/ui/app/Main.java ~/projects/attic/iccj-Main.java.jfx

Checked in

populate icc props:
icc.properties in /opt/icc/conf
Messages bundles in /opt/icc/conf

ui design

main class:
get property source
get localizer
create main ui

main panel

ui props in prop file:
iccRefreshNeighbors=90
iccRefreshNodeInfo=10
iotaDownloadLink=http://85.93.93.110
iotaDownloadFilename=IRI-1.1.0.jar

main menu

controller

proxy

Checked in
----------
Mon 11/28/16

temp comment out props and localizer to get layout done

Give ServerTabpanel has preferred size

Set nimbus L&F

Add appassembler build to gen script and zip it all up

Copy property files to appassembler conf dir

.bat file runs on windows

Rename artifact to icc

Property files loaded from appassembler conf dir

Make server tab expandable

Local tab label localizable

Fixed main menu

ConfigServerDialog

Checked in

Add/Edit Server Dialog

ICC Settings dialog

OpenServerDialog

server settigns dialog

server panel

nbr panel: nbr model, table, panel

server action panel

console log panel

checkin
----------
Wed 11/30/16

fix console log size

get right vertical spacing of server action buttons

Console log header on console log

Footer panel

set nbr table col max sizes

need main window title: IOTA Control Center

server action buttons to be same width

add bevel borders to scrollables

checked in

----------
Thu: 12/1/16

open add svr menu is offset from icc settings button label

Load server list:
name
ip
portNumber
apiAccessKey
walletStartCmd

servers is a map (id -> properties) of Properties key -> val

populate open server dialog

make open server action buttons same width

Fixed second time open server is called no server names are there

set desired color for server action buttons

need server action buttons tool tip text

handle edit server

handle add server

persist save server changes

enforce unique server names

handle server name name changes: tab label change, jlist change

put default for iccr  port

handle open server from mm

handle open server from dialog

handle remove selected server from dialog

don't have server tab open twice

checked in

query for iccr settings on node:
proxy/http

httpproxy that uses resteasy client

copy of iccrservice into iccj ui proxy 

example of iccrGetConfig rsponse
response status: 200
iccrStartAtStartup->false
iccrStartIotaAtStartup->false
iccrStopIotaAtShutdown->false
iotaPortNumber->14265
iotaDownloadLink->http://85.93.93.110
iotaDownloadFilename->IRI-1.1.0.jar
iotaDir->/opt/iota
iotaStartCmd->java -jar IRI.jar
iotaNeighborRefreshTime->10

checked in

--------------
Fri: 12/2/16

HttpProxy checks status, throws bad resp exc if not ok

add new server  props to iccj

iota actions

checked in

-----------------
Sat: 12/3/16

Get actionresponse from all action calls

do initial prompt to connect to local server

on first load of tab, connect, get status

print api call was successful to log

first prompt  needs to come after UI is displayed?

main panel needs preferred size

extract caused by exception from http client

checked in

use iccr get prop(key) to get nbr list, and set  prop (key) to set nbr list resorces in iccr

added get prop key

added get nbr prop

added inserts to table model

added remove selected nbr panel button

add remove are you sure prompt

added add nbr panel button

mechanism to add nbrs to table

mechanism to edit nbrs in table

mechanism to add and remove neighbors

persist nbr changes

enable save nbr only when added, removed, or changed

localize dialg save validation error failure error dialo title

checked in

icc settings dialog

send dld link and filename as actionprops to install iota cmd

checked in

-------------------
Sun: 12/4/2016

on delete db, if iota was running, restrt it after delete

support for api key

on api key change, change proxy header

checked in

test update nbrs: if active, remove if not empty, add new

Display the open server dialog after adding a new server config

checked in

On server remove selcted, prompt user to delete server config

Added swingworker thread task to do api calls on bkground thread, then put on awt thread when done
on open of new server, it will try to connect, and not display tab until answers or timesout

Moved all iota actions off onto worker threads

Add server names to error dialogs

checkin

periodic query for  iota node info

periodic query for iota nbrs

checkin

---------
Mon: 12/5/2016

stop/stop timers on iota stop/start

Not show wallet cmd field on new server create dialog, only on edit

Add Run IOTA Refresh checkbox to server action panel

Display ICCR event log in scrollable dialog with text area like console log

ICCR Event log dialog has delete event log button

ICC will do IOTA status check after install iota

checkin

delivered 1.0.0

2240  cd target/
 2241  ls
 2242  cd appassembler/
 2243  ls
 2244  more repo/
 2245  ls conf/
 2246  emacs -nw conf/icc.properties 
 2247  ls
 2248  mkdir ../../dist
 2249  mkdir ../../dist/iccj
 2250  pwd
 2251  ls
 2252  cd ..
 2253  mv appassembler iccj
 2254  ls
 2255  man zip
 2256  zip -r ~/iccj.zip iccj
 2257  ls -la ~/
 2258  ls -la ~/iccj.zip ~/iccr.tgz 
 2259  history
 2260  cd ~/
 2261  ls /opt
 2262  pwd
 2263  cd /opt
 2264  ls -la
 2265  cd
 2266  ls
 2267  ls -la
 2268  ls -l
 2269  mv iccj.zip iccj-0.0.1.zip
 2270  mv iccr.tgz iccr-0.0.1.tgz


mv appassembler iccj
zip -r ~/iccj.zip iccj


ls -la ~/iccj.zip ~/iccr.tgz 
-rw-rw-r-- 1 dana dana  5927758 Dec  5 09:44 /home/dana/iccj.zip
-rw-rw-r-- 1 dana dana 46952474 Dec  5 09:41 /home/dana/iccr.tgz

------
Tue: 12/6/2016

add changelog.text

Change text of main menu "Open or Add Server" menu item label to "Servers"
mainMenuOpenOrAddServerLabel=Servers

Change text of main menu Servers -> "Open Server" menu item to "Open or Close Connection"
mainMenuOpenServerLabel=Open or Close Connection...

Change text of Servers dialog "Remove Selected" to "Close Or Remove Selected"
buttonLabelRemoveSelected=Close Or Remove Selected

Change text of initial add server message
initialAddServerMsg=Use the main menu Servers / Add New Server to define a new ICCR server

Remove Wallet command from server configuration

Remove Start Wallet from server action panel.

Changed the Server Start IOTA background color from bright green to dark green

Support IP v6 and DNS hostname for nbr addresses by removing check for IPv4

Support IP v6 and DNS hostname for server addresses by removing check for IPv4

Add AT, IT, and NT columns to nbr table, first 3 columns

Added text neighborTableColumnTitleAT=AT

Added text neighborTableColumnTitleIT=IT

Added text neighborTableColumnTitleNT=NT

Changed fieldLabelRemoteServerIp=Server

Changed fieldLabelServerName=Server Name

Changed neighborTableColumnTitleNeighbor=Neighboring Node Address

Changed neighborTableIpError=Invalid neighbor address

Fixed width of nbr col 1 ...

Fixed exception adding nbr

Fix parsing of new nbr into, just do uri:

Bumped iccj version to 1.0.1-SNAPSHOT

Show IOTA log

checked in

Show nbr metrics in nbr table
use gson to create iota  nbr response
set nbr data in table

Display node info in footer
use gson to create iota  node info response

checkin

Support https:
cp ~/projects/pki/icc/server/stores/iccj-ks.jks src/main/config/
enabled ssl
support nossl on commandline

checked in

mkdir /opt/icc/bin
mkdir /opt/icc/conf
mkdir /opt/icc/repo

new deploy-iccj.bash script: pass binonly on cmd line to only deploy jar

Change Servers -> Open close to Manage
mainMenuOpenServerLabel=Manage...

Change Open Server dialog title to Manage Servers
dialogTitleOpenServer=Manage Servers

fixed https

verified nbr info updates table

checked in
----------------
Fri: 12/9/2016

Fix nbr metrics finding nbr in table

Use single port for http or https

checked in

Release checklist:

mvn clean install
clean deployed dir
   /opt$ sudo mv icc icc-pre-1.0.1

mkdir new icc dir:
      sudo mkdir icc
      /opt$ sudo chown dana:dana icc
      mkdir /opt/icc/repo
      mkdir /opt/icc/bin
      mkdir /opt/icc/conf

run deploy script
    iccj$ ./deploy-iccj.bash

zip icc at at the /opt level:
    /opt$ mkdir ~/projects/dist
    /opt$ zip -r ~/projects/dist/iccj-1.0.1.zip icc

test:
    /opt$ sudo mv icc icc-1.0.1-dist
    /opt$ sudo unzip ~/projects/dist/iccj-1.0.1.zip
    /opt$ sudo chown -R dana:dana icc

upload zip archive:

upload change log:
       ~/projects/iccj$ cp changelog.txt ~/projects/dist/iccj-1.0.1-changelog.txt

-----------------
Sat: 12/10/2016

bump artifact version to 1.0.2-SNAPSHOT

Adjusted initial ICC open sequence:
* if no servers defined, then show this message: initialAddServerMsg=Use the main menu Servers / Add New Server to define a new ICCR server
* if server(s) are defined, then automatically show the manage servers dialog (dialogTitleOpenServer=Manage Servers)

Change Neighbor table Status column header to be Active instead of Status
neighborTableColumnTitleStatus=Active

Added Neighbor Table column tool tip localized text:
neighborTableColumnTitleATTooltip=All transactions received
neighborTableColumnTitleITTooltip=Invalid transactions received
neighborTableColumnTitleNTTooltip=New transactions received
neighborTableColumnTitleStatusTooltip=When checked, the neighbor is active and will be added to IOTA
neighborTableColumnTitleNeighborTooltip=Address (DNS name or IPv4 or IPv6 address) of a neighbor to be added to IOTA
neighborTableColumnTitleDescriptionTooltip=Optional description of the IOTA neighbor

Fixed neighbor table ipv6 comparison.

Checked in

Moved Run IOTA refresh into icc settings window, default to on

Changed 
buttonLabelRunIotaRefresh=Run IOTA Neighbor and NodeInfo Refresh

Fixed changes to "Time for ICC to Refresh" don't take effect unless enabling run iota refresh

New icc property: runIotaRefresh

checked in

Feedback:
d 1) Move Run IOTA refresh into icc settings window, default to on
d 2) Provide tooltip for AT, IT, NT
d 3) Make AT, IT, NT, and IP columns be resizable 

Fixes:
d 4) Changes to "Time for ICC to Refresh" don't take effect unless enabling run iota refresh
d 5) IPv6 IOTA nbrs metrics are not updated in ICC nbr table.

6) Automatic refresh of IPs to IRI
7) Add auto-scroll to ICCJ console log, new log output causes scroll to bottom automatically
8) Implement "Seen Transactions" metric in ICC UI footer

Also:
9) Implement Online status in ICC UI footer
10) Add ICC app icon instead of default java coffee cup

d 11) Adjusted initial ICC open sequence
d 12) Change Neighbor table Status column header to be Active instead of Status

todo:
Add dto for IotaNodeInfo:
{"appName": "IRI", "appVersion": "1.1.1.1", "jreAvailableProcessors": 8, "jreFreeMemory": 91999048, "jreMaxMemory": 7436500992, "jreTotalMemory": 216006656, "latestMilestone": "MYCIGBUNWHBZNJEDVERPCXA9AOGU9TUZPCNEYCGCCOXDRN9PODOPVWFLJDEZDDZUQ9BSFASUNRB999999", "latestMilestoneIndex": 8765, "latestSolidSubtangleMilestone": "MYCIGBUNWHBZNJEDVERPCXA9AOGU9TUZPCNEYCGCCOXDRN9PODOPVWFLJDEZDDZUQ9BSFASUNRB999999", "latestSolidSubtangleMilestoneIndex": 8765, "neighbors": 7, "packetsQueueSize": 0, "time": 1481405742423, "tips": 852, "transactionsToRequest": 0, "duration": 3}

For seen transaction metric in footer:
The transactions data in IRI log:
Confirmed transactions = 24970
6 tails need to be analyzed
31 extra transactions approved
Confirmed transactions = 25001
36 tails need to be analyzed
2 extra transactions approved
Transactions to request = 0 / 26743 (829 ms / 0%)
and:
Confirmed transactions = 24738
21 tails need to be analyzed
52 extra transactions approved
Confirmed transactions = 24790
35 tails need to be analyzed
1 extra transactions approved

Add nbr tbl col sorting

Add auto tail of IRI log with longpoll feed to icc when iri log is open

IOTA log takes a long time to load if it is really big

Create a install-icc script:
cd /opt
sudo unzip
ask for user
ask for group
chown -R




validate that no scheme is on server address  property

set footer online

Discovery of existing IOTA nodes:
if not in table: add?

button to clear console log?

don't enable nbr save changes until they add/remove/edit?


Finish change log
Make release of 1.0.1
Make patch
Upload to g drive
Msg Pascal

doc how to use wget and curl to execute iccr api with header

doc how to use wget and curl to execute iccr api with https

or a icc-cli, built from iccr components and does agent work and actions directly

need scheme config for server, http or https

fix nbr uri parsing if scheme is emptied, it sets scheme to whole ip //1.1.1.1



?Add (in seconds) sub label to icc settings dialog

iccr actions

?need scheme prop for  nbr,udp or tcp

checkin prop files or put in another mvn sub module

do us

us: add lang locale and country locale to icc props

us: When the ICC is on system with no local iota node, initial prompt to load local.

questions:
ICC Settings: time for icc to refresh nbrs status being 90 seconds is to display the server tab's neighbors table?
ICC Settings: time for icc to refresh node info is for updating what, the footer and just a health and status check?

What is online in footer?

Remove selected is remove from server tab panel as well as delete server configuration? Right now it prompts...







